# 变更代码覆盖率

变更代码覆盖率需要设置一个基线，可以是Commit Sha或者Branch。

import { Callout } from 'nextra/components';
import LocalizedLink from "../../../../components/LocalizedLink";

<Callout type="info" emoji="ℹ️">
  基线的配置可以参考 <LocalizedLink href={'/documentation/ecosystem/babel-plugin-canyon#配置'}>compareTarget</LocalizedLink> 配置
</Callout>

## 计算

### 逻辑
1. 遍历新增行，判断是否在语句、分支、函数覆盖率的范围内
2. 只统计在范围内的新增行
3. 在范围内，且他们的 `hit` 大于0，就是覆盖的

<Callout type="info" emoji="ℹ️">
  具体逻辑可参考[源代码](https://github.com/canyon-project/canyon/blob/main/packages/canyon-data/src/utils/line.ts#L26)
</Callout>

### 公式
$\text{变更代码行覆盖率} = \frac{\text{已覆盖新增行数}}{\text{符合条件1的新增行数}}$
