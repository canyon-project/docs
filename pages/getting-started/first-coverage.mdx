# ä¸ŠæŠ¥ç¬¬ä¸€ä¸ªè¦†ç›–ç‡

## ä»£ç æ’æ¡©

å‰ç«¯å·¥ç¨‹åŒ–ã€æ¨¡å—åŒ–ç¦»ä¸å¼€babelã€‚å¦‚æœè¯´ä½ çš„é¡¹ç›®æ˜¯çš„è¯ï¼Œåªéœ€è¦å®‰è£…ä¸¤ä¸ªbabelæ’ä»¶å³å¯å¿«é€Ÿå¼€å§‹ï¼Œ
[`babel-plugin-istanbul`](https://github.com/istanbuljs/babel-plugin-istanbul) æ˜¯istanbulå®˜æ–¹ç»´æŠ¤çš„babelæ’ä»¶ã€‚
[`babel-plugin-canyon`](https://github.com/canyon-project/babel-plugin-canyon) æˆ‘ä»¬æ˜¯ä¸ºäº†ä¾¿äºç”¨æˆ·é…ç½®é¡¹ç›®ä¿¡æ¯çš„babelæ’ä»¶ã€‚

### å®‰è£…

```shell copy
npm i babel-plugin-istanbul babel-plugin-canyon -D
```

### é…ç½®

åœ¨[babel](https://babeljs.io/docs/config-files#configuration-file-types)ä¸­é…ç½®
```json
{
  "plugins": [
    "istanbul",
    "canyon"
  ]
}
```

babelå®‰è£…å®Œæˆåå¯åŠ¨é¡¹ç›®ï¼Œåœ¨æ§åˆ¶æ‰“å°**window.\_\_canyon\_\_**ä¸**window.\_\_coverage\_\_**ã€‚å¦‚æœè·Ÿä¸‹å›¾ä¸€æ ·é‚£ä¹ˆæ­å–œä½ ï¼Œä»£ç æ’æ¡©æˆåŠŸã€‚

<Callout emoji="ğŸ’¡">
    æœ¬åœ°å¼€å‘ç¯å¢ƒä¸‹canyonä¸‹çš„å˜é‡æ˜¯ä¸ä¼šå­˜åœ¨çš„ï¼Œåªæœ‰åœ¨CIç¯å¢ƒä¸­æ‰ä¼šå­˜åœ¨ã€‚

    1. æœ¬åœ°è°ƒè¯•æ—¶å¯ä»¥æ‰‹åŠ¨é…ç½®canyonæ’ä»¶ï¼Œå…·ä½“å¯æŸ¥çœ‹[æ‰‹åŠ¨é…ç½®](https://github.com/canyon-project/babel-plugin-canyon)ã€‚

    2. å„å˜é‡çš„å«ä¹‰å¯æŸ¥çœ‹[å˜é‡è¯´æ˜](/reference/api)ã€‚
</Callout>

![coverage-canyon-console](/coverage-canyon-console.png)



## æ„å»ºæ—¶ç¯å¢ƒå˜é‡é…ç½®

åœ¨CIç¯å¢ƒä¸­ï¼Œæˆ‘ä»¬éœ€è¦é…ç½®ä¸€äº›ç¯å¢ƒå˜é‡ï¼Œç”¨äºä¸ŠæŠ¥è¦†ç›–ç‡æ•°æ®ã€‚

### è·å–DSNä¸REPORTER

- DSN: Canyonæä¾›çš„ä¸ŠæŠ¥æ¥å£ï¼Œ\{\{url\}\}/coverage/clientï¼Œå…¶ä¸­urlä¸ºcanyonæœåŠ¡åœ°å€ã€‚
- REPORTER: ç”¨æˆ·tokenï¼Œç”¨äºåŒºåˆ†ä¸åŒçš„ç”¨æˆ·ã€‚å¯å‰å¾€ç”¨æˆ·è®¾ç½®é¡µæŸ¥çœ‹ã€‚

![setting](/setting.png)

### CIå¹³å°å˜é‡é…ç½®

![gitlab](/gitlab-var-config.png)

import { Callout } from 'nextra/components'

<Callout type="info" emoji="â„¹ï¸">
    å…¶ä¸­Branchã€SHAã€Project IDä¸éœ€è¦é…ç½®ï¼Œä¼šè‡ªåŠ¨è¯»å–ç¯å¢ƒå˜é‡ã€‚æˆ‘ä»¬å·²ç»é€‚é…äº†gitlab pipelineã€github actionç­‰CIå¹³å°ã€‚
    å…·ä½“å¯æŸ¥çœ‹[æ”¯æŒçš„provideråˆ—è¡¨](/reference/supported-ci-providers)ã€‚
</Callout>






## æµ‹è¯•ä¸ä¸ŠæŠ¥

### UIè‡ªåŠ¨åŒ–

ä½¿ç”¨è€…å¯ä»¥ä½¿ç”¨ä»»ä½•UIè‡ªåŠ¨åŒ–æµ‹è¯•æ¡†æ¶ï¼Œå¦‚cypressã€playwrightã€puppeteerã€seleniumç­‰ã€‚åªéœ€è¦åœ¨æµ‹è¯•ç»“æŸåï¼Œå°†è¦†ç›–ç‡æ•°æ®ä¸ŠæŠ¥å³å¯ã€‚

å…·ä½“å¯å‚è€ƒ[UIè‡ªåŠ¨åŒ–æµ‹è¯•](/end-to-end-testing/playwright)ã€‚

### æ‰‹å·¥ä¸ŠæŠ¥

chromeå¯ä»¥ä½¿ç”¨chromeæ’ä»¶[canyon-extension](https://chromewebstore.google.com/detail/canyon-extension/omnpafdjidgpdmlimbangcjjaaodbeof?hl=zh-CN&utm_source=ext_sidebar)æ‰‹å·¥ä¸ŠæŠ¥è¦†ç›–ç‡æ•°æ®ã€‚

![chrome-crx](/chrome-crx.png)

## æŠ¥å‘ŠæŸ¥çœ‹

Canyonæä¾›äº†ä¸°å¯Œçš„æŠ¥å‘Šï¼Œå¯ä»¥æŸ¥çœ‹è¦†ç›–ç‡çš„æ‘˜è¦ä¸è¦†ç›–è¯¦æƒ…ã€‚

### æ‘˜è¦

![report-overview](/report-overview.png)

### è¯¦æƒ…

![report-detail](/report-detail.png)